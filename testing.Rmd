---
title: "R Notebook"
output: html_notebook
---

Ricardo will use this file to test all the plots and stats. Feel free to do that too. We'll add it to gitignore later.

```{r}
# This is a placeholder idea: ICU admissions being greater on average in Q4

ICU_quarter <- activity_specialty %>%
  filter(specialty == "CC") %>% 
  count(quarter) %>% 
  mutate(quarter = case_when(
    str_detect(quarter, "Q1") ~ "Q1",
    str_detect(quarter, "Q2") ~ "Q2",
    str_detect(quarter, "Q3") ~ "Q3",
    str_detect(quarter, "Q4") ~ "Q4"))
    

ICU_quarter %>% 
  ggplot(aes(n, quarter)) +
  geom_boxplot()
```

```{r}
# Same thing with histograms
ICU_quarter %>% 
  ggplot(aes(quarter, n)) +
  geom_col()
```

```{r}
ICU_quarter %>% 
  group_by(quarter) %>% 
  summarise(mean = mean(n))
```


```{r}
ICU_quarter %>% 
  filter(quarter %in% c("Q3", "Q4")) %>%
  specify(n ~ quarter) %>% 
  hypothesise(null = "independence") %>% 
  generate(reps = 10000, type = "permute") %>% 
  calculate(stat = "diff in means", order = c("Q4", "Q3")) %>% 
  visualise() +
  shade_pvalue(obs_stat = 81 - 63, direction =  "right")
```

